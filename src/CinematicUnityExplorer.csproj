<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="$(SolutionDir)GamePath.props" Condition="Exists('$(SolutionDir)GamePath.props')" />
  
  <PropertyGroup>
    <OutputType>Library</OutputType>
    <PlatformTarget>AnyCPU</PlatformTarget>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <AllowedReferenceRelatedFileExtensions>none</AllowedReferenceRelatedFileExtensions>
    <DebugSymbols>false</DebugSymbols>
    <DebugType>none</DebugType>
    <RootNamespace>CinematicUnityExplorer</RootNamespace>
    <LangVersion>10.0</LangVersion>
    <IncludeSourceRevisionInInformationalVersion>false</IncludeSourceRevisionInInformationalVersion>
    <Configurations>STANDALONE_Mono;Debug</Configurations>
    <TargetFramework>net481</TargetFramework>
  </PropertyGroup>

  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <ItemGroup Condition="'$(Configuration)'=='STANDALONE_Mono'">
      <Exec Command="dotnet build ..\UniverseLib\src\UniverseLib.sln -c Release_Mono" />
    </ItemGroup>
  </Target>

  <ItemGroup>
    <EditorConfigFiles Remove=".editorconfig" />
  </ItemGroup>
  
  <!-- STANDALONE Mono -->
  <PropertyGroup Condition="'$(Configuration)'=='STANDALONE_Mono'">
    <TargetFramework>net481</TargetFramework>
    <OutputPath>..\Release\CinematicUnityExplorer.Standalone.Mono\</OutputPath>
    <DefineConstants>MONO,STANDALONE</DefineConstants>
    <AssemblyName>CinematicUnityExplorer.STANDALONE.Mono</AssemblyName>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='STANDALONE_Mono|AnyCPU'">
    <DebugType>portable</DebugType>
  </PropertyGroup>
  
  <!-- ~~~~~ NUGET ~~~~~ -->
  <ItemGroup>
    <PackageReference Include="BepInEx.AssemblyPublicizer.MSBuild" Version="0.4.2">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Samboy063.Tomlet" Version="3.1.3" />
    <PackageReference Include="Microsoft.Unity.Analyzers" Version="1.16.1">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
  </ItemGroup>

  <!-- mono nuget -->

  <!-- ~~~~~ ASSEMBLY REFERENCES ~~~~~ -->
  <!-- net6 -->
  <ItemGroup Condition="'$(TargetFramework)'=='net6'">
    <Reference Include="mcs">
      <HintPath>..\lib\net6\mcs.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <!-- net35 / net472 -->
  <ItemGroup Condition="'$(TargetFramework)'=='net35' or '$(TargetFramework)'=='net472' or '$(TargetFramework)'=='net481'">
    <Reference Include="mcs">
      <HintPath>..\lib\net35\mcs.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <!-- Mono -->
  <ItemGroup Condition="'$(Configuration)'=='STANDALONE_Mono'">
    <Reference Include="$(WrathInstallDir)\Wrath_Data\Managed\Unity*.dll" Private="false" Publicize="True" />
    <Reference Include="$(WrathInstallDir)\Wrath_Data\Managed\UnityModManager\0Harmony.dll*" Private="false" />
    <Reference Include="UniverseLib">
      <HintPath>..\UniverseLib\Release\UniverseLib.Mono\UniverseLib.Mono.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
</Project>